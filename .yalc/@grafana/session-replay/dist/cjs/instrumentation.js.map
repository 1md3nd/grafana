{"version":3,"file":"instrumentation.js","sourceRoot":"","sources":["../../src/instrumentation.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;AAAA,+BAA+B;AAE/B,gDAAwE;AAGxE;;;;;;GAMG;AACH;IAAkD,gDAAmB;IAArE;QAAA,qEAsBC;QArBU,UAAI,GAAG,sCAAsC,CAAC;QAC9C,aAAO,GAAG,mBAAO,CAAC;;IAoB7B,CAAC;IAhBC,iDAAU,GAAV;QACE,IAAI,CAAC,MAAM,GAAG,IAAA,cAAM,EAAC;YACnB,IAAI,EAAE,UAAC,KAAK;;gBACV,gBAAI,CAAC,GAAG,CAAC,SAAS,CAAC,cAAc,EAAE;oBACjC,WAAW,EAAE,KAAK,CAAC,SAAS,CAAC,QAAQ,EAAE;oBACvC,OAAO,EAAE,MAAA,MAAA,KAAK,CAAC,KAAK,0CAAE,QAAQ,EAAE,mCAAI,EAAE;oBACtC,MAAM,EAAE,KAAK,CAAC,IAAI,CAAC,QAAQ,EAAE;oBAC7B,MAAM,EAAE,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,IAAI,CAAC;iBACnC,CAAC,CAAC;YACL,CAAC;SACF,CAAC,CAAC;IACL,CAAC;IAED,8CAAO,GAAP;QACE,IAAI,CAAC,MAAM,EAAE,CAAC;IAChB,CAAC;IACH,mCAAC;AAAD,CAAC,AAtBD,CAAkD,+BAAmB,GAsBpE;AAtBY,oEAA4B","sourcesContent":["import { record } from 'rrweb';\n\nimport { BaseInstrumentation, faro, VERSION } from '@grafana/faro-core';\n\n\n/**\n * Instrumentation for Performance Timeline API\n * @see https://developer.mozilla.org/en-US/docs/Web/API/PerformanceTimeline\n *\n * !!! This instrumentation is in experimental state and it's not meant to be used in production yet. !!!\n * !!! If you want to use it, do it at your own risk. !!!\n */\nexport class SessionReplayInstrumentation extends BaseInstrumentation {\n  readonly name = '@grafana/faro-web-sdk:session-replay';\n  readonly version = VERSION;\n\n  private stopFn: any;\n\n  initialize(): void {\n    this.stopFn = record({\n      emit: (event) => {\n        faro.api.pushEvent('replay_event', {\n          \"timestamp\": event.timestamp.toString(),\n          \"delay\": event.delay?.toString() ?? \"\",\n          \"type\": event.type.toString(),\n          \"data\": JSON.stringify(event.data),\n        });\n      },\n    });\n  }\n\n  destroy(): void {\n    this.stopFn();\n  }\n}\n"]}