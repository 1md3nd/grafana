{
  "kind": "QueryTypeDefinitionList",
  "apiVersion": "query.grafana.app/v0alpha1",
  "metadata": {
    "resourceVersion": "1708133072599"
  },
  "items": [
    {
      "metadata": {
        "name": "math",
        "resourceVersion": "1708133072599",
        "creationTimestamp": "2024-02-17T01:24:32Z"
      },
      "spec": {
        "discriminatorField": "queryType",
        "discriminatorValue": "math",
        "querySchema": {
          "$schema": "https://json-schema.org/draft-04/schema",
          "properties": {
            "expression": {
              "type": "string",
              "minLength": 1,
              "examples": [
                "$A + 1",
                "$A/$B"
              ]
            }
          },
          "additionalProperties": false,
          "type": "object",
          "required": [
            "expression"
          ]
        },
        "examples": [
          {
            "name": "constant addition",
            "queryPayload": {
              "expression": "$A + 10"
            }
          },
          {
            "name": "math with two queries",
            "queryPayload": {
              "expression": "$A - $B"
            }
          }
        ]
      }
    },
    {
      "metadata": {
        "name": "reduce",
        "resourceVersion": "1708133072599",
        "creationTimestamp": "2024-02-17T01:24:32Z"
      },
      "spec": {
        "discriminatorField": "queryType",
        "discriminatorValue": "reduce",
        "querySchema": {
          "$schema": "https://json-schema.org/draft-04/schema",
          "properties": {
            "expression": {
              "type": "string",
              "minLength": 1,
              "examples": [
                "$A"
              ]
            },
            "reducer": {
              "type": "string"
            },
            "settings": {
              "properties": {
                "mode": {
                  "type": "string"
                },
                "replaceWithValue": {
                  "type": "number"
                }
              },
              "additionalProperties": false,
              "type": "object",
              "required": [
                "mode"
              ]
            }
          },
          "additionalProperties": false,
          "type": "object",
          "required": [
            "expression",
            "reducer"
          ]
        },
        "examples": [
          {
            "name": "get max value",
            "queryPayload": {
              "expression": "$A",
              "reducer": "max",
              "settings": {
                "mode": "dropNN"
              }
            }
          }
        ]
      }
    },
    {
      "metadata": {
        "name": "resample",
        "resourceVersion": "1708133072599",
        "creationTimestamp": "2024-02-17T01:24:32Z"
      },
      "spec": {
        "discriminatorField": "queryType",
        "discriminatorValue": "resample",
        "querySchema": {
          "$schema": "https://json-schema.org/draft-04/schema",
          "properties": {
            "expression": {
              "type": "string",
              "minLength": 1,
              "examples": [
                "$A + 1",
                "$A"
              ]
            },
            "window": {
              "type": "string",
              "minLength": 1,
              "examples": [
                "1w",
                "10m"
              ]
            },
            "downsampler": {
              "type": "string"
            },
            "upsampler": {
              "type": "string"
            }
          },
          "additionalProperties": false,
          "type": "object",
          "required": [
            "expression",
            "window",
            "downsampler",
            "upsampler"
          ]
        },
        "examples": [
          {
            "name": "resample at a every day",
            "queryPayload": {
              "expression": "$A",
              "window": "1d",
              "downsampler": "",
              "upsampler": ""
            }
          }
        ]
      }
    },
    {
      "metadata": {
        "name": "classic_conditions",
        "resourceVersion": "1708133072599",
        "creationTimestamp": "2024-02-17T01:24:32Z"
      },
      "spec": {
        "discriminatorField": "queryType",
        "discriminatorValue": "classic_conditions",
        "querySchema": {
          "$schema": "https://json-schema.org/draft-04/schema",
          "properties": {
            "conditions": {
              "items": {
                "properties": {
                  "evaluator": {
                    "properties": {
                      "params": {
                        "items": {
                          "type": "number"
                        },
                        "type": "array"
                      },
                      "type": {
                        "type": "string"
                      }
                    },
                    "additionalProperties": false,
                    "type": "object",
                    "required": [
                      "params",
                      "type"
                    ]
                  },
                  "operator": {
                    "properties": {
                      "type": {
                        "type": "string"
                      }
                    },
                    "additionalProperties": false,
                    "type": "object",
                    "required": [
                      "type"
                    ]
                  },
                  "query": {
                    "properties": {
                      "params": {
                        "items": {
                          "type": "string"
                        },
                        "type": "array"
                      }
                    },
                    "additionalProperties": false,
                    "type": "object",
                    "required": [
                      "params"
                    ]
                  },
                  "reducer": {
                    "properties": {
                      "type": {
                        "type": "string"
                      }
                    },
                    "additionalProperties": false,
                    "type": "object",
                    "required": [
                      "type"
                    ]
                  }
                },
                "additionalProperties": false,
                "type": "object",
                "required": [
                  "evaluator",
                  "operator",
                  "query",
                  "reducer"
                ]
              },
              "type": "array"
            }
          },
          "additionalProperties": false,
          "type": "object",
          "required": [
            "conditions"
          ]
        },
        "examples": [
          {
            "name": "do classic query (TODO)",
            "queryPayload": {
              "conditions": []
            }
          }
        ]
      }
    },
    {
      "metadata": {
        "name": "threshold",
        "resourceVersion": "1708133072599",
        "creationTimestamp": "2024-02-17T01:24:32Z"
      },
      "spec": {
        "discriminatorField": "queryType",
        "discriminatorValue": "threshold",
        "querySchema": {
          "$schema": "https://json-schema.org/draft-04/schema",
          "properties": {
            "expression": {
              "type": "string",
              "minLength": 1,
              "examples": [
                "$A"
              ]
            },
            "conditions": {
              "items": {
                "properties": {
                  "evaluator": {
                    "properties": {
                      "params": {
                        "items": {
                          "type": "number"
                        },
                        "type": "array"
                      },
                      "type": {
                        "type": "string"
                      }
                    },
                    "additionalProperties": false,
                    "type": "object",
                    "required": [
                      "params",
                      "type"
                    ]
                  },
                  "unloadEvaluator": {
                    "properties": {
                      "params": {
                        "items": {
                          "type": "number"
                        },
                        "type": "array"
                      },
                      "type": {
                        "type": "string"
                      }
                    },
                    "additionalProperties": false,
                    "type": "object",
                    "required": [
                      "params",
                      "type"
                    ]
                  },
                  "loadedDimensions": {
                    "additionalProperties": true,
                    "type": "object",
                    "x-grafana-type": "data.DataFrame"
                  }
                },
                "additionalProperties": false,
                "type": "object",
                "required": [
                  "evaluator",
                  "unloadEvaluator",
                  "loadedDimensions"
                ]
              },
              "type": "array"
            }
          },
          "additionalProperties": false,
          "type": "object",
          "required": [
            "expression",
            "conditions"
          ]
        },
        "examples": [
          {
            "name": "TODO... a threshold query",
            "queryPayload": {
              "expression": "$A",
              "conditions": null
            }
          }
        ]
      }
    }
  ]
}